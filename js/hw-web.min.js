(function(e){var t=[],n=function(){},r={defaultPath:"/",before:n,on:n,notfound:n},o={current:null,previous:null,config:function(e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return o},add:function(e,n,r){return e&&n&&("function"==typeof n&&(r=n,n=null),t.push({path:e,name:n,fn:r||function(){}})),o},go:function(e){return location.hash=e,o},back:function(e){return o.previous?(history.back(),o.previous=null):e&&(location.hash=e),o}},i=function(){var e=location.hash.slice(1),n=!1,i=o.current;e||(e=r.defaultPath),i&&i!=o.previous&&(o.previous=i),o.current=e;
for(var s=0,a=t.length;a>s&&!n;s++){var l=t[s],c=l.path,u=l.name,f=l.fn;if("string"==typeof c)c.toLowerCase()==e.toLowerCase()&&(r.before.call(o,c,u),f.call(o),r.on.call(o,c,u),n=!0);else{var m=e.match(c);m&&(r.before.call(o,c,u,m),f.apply(o,m),r.on.call(o,c,u,m),n=!0)}}return n||r.notfound.call(o),o};o.init=function(){return e.addEventListener("hashchange",i),i()},o.reload=i,e.ruto=o})(window),function(e,t){function n(e,n){r.addType(e,function(i,s,a){var l,c,u,f,m=s,p=(new Date).getTime();if(!i){m={},f=[],u=0;
try{for(i=n.length;i=n.key(u++);)o.test(i)&&(c=JSON.parse(n.getItem(i)),c.expires&&p>=c.expires?f.push(i):m[i.replace(o,"")]=c.data);for(;i=f.pop();)n.removeItem(i)}catch(d){}return m}if(i="__amplify__"+i,s===t){if(l=n.getItem(i),c=l?JSON.parse(l):{expires:-1},!(c.expires&&p>=c.expires))return c.data;n.removeItem(i)}else if(null===s)n.removeItem(i);else{c=JSON.stringify({data:s,expires:a.expires?p+a.expires:null});try{n.setItem(i,c)}catch(d){r[e]();try{n.setItem(i,c)}catch(d){throw r.error()}}}return m
})}var r=e.store=function(e,t,n){var o=r.type;return n&&n.type&&n.type in r.types&&(o=n.type),r.types[o](e,t,n||{})};r.types={},r.type=null,r.addType=function(e,t){r.type||(r.type=e),r.types[e]=t,r[e]=function(t,n,o){return o=o||{},o.type=e,r(t,n,o)}},r.error=function(){return"amplify.store quota exceeded"};var o=/^__amplify__/;for(var i in{localStorage:1,sessionStorage:1})try{window[i].setItem("__amplify__","x"),window[i].removeItem("__amplify__"),n(i,window[i])}catch(s){}if(!r.types.localStorage&&window.globalStorage)try{n("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===r.type&&(r.type="globalStorage")
}catch(s){}(function(){if(!r.types.localStorage){var e=document.createElement("div"),n="amplify";e.style.display="none",document.getElementsByTagName("head")[0].appendChild(e);try{e.addBehavior("#default#userdata"),e.load(n)}catch(o){return e.parentNode.removeChild(e),t}r.addType("userData",function(o,i,s){e.load(n);var a,l,c,u,f,m=i,p=(new Date).getTime();if(!o){for(m={},f=[],u=0;a=e.XMLDocument.documentElement.attributes[u++];)l=JSON.parse(a.value),l.expires&&p>=l.expires?f.push(a.name):m[a.name]=l.data;
for(;o=f.pop();)e.removeAttribute(o);return e.save(n),m}if(o=o.replace(/[^\-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-"),o=o.replace(/^-/,"_-"),i===t){if(a=e.getAttribute(o),l=a?JSON.parse(a):{expires:-1},!(l.expires&&p>=l.expires))return l.data;e.removeAttribute(o)}else null===i?e.removeAttribute(o):(c=e.getAttribute(o),l=JSON.stringify({data:i,expires:s.expires?p+s.expires:null}),e.setAttribute(o,l));try{e.save(n)}catch(d){null===c?e.removeAttribute(o):e.setAttribute(o,c),r.userData();
try{e.setAttribute(o,l),e.save(n)}catch(d){throw null===c?e.removeAttribute(o):e.setAttribute(o,c),r.error()}}return m})}})(),function(){function e(e){return e===t?t:JSON.parse(JSON.stringify(e))}var n={},o={};r.addType("memory",function(r,i,s){return r?i===t?e(n[r]):(o[r]&&(clearTimeout(o[r]),delete o[r]),null===i?(delete n[r],null):(n[r]=i,s.expires&&(o[r]=setTimeout(function(){delete n[r],delete o[r]},s.expires)),i)):e(n)})}()}(this.amplify=this.amplify||{});var Hogan={};(function(e,t){function n(e,t,n){var r;
return t&&"object"==typeof t&&(null!=t[e]?r=t[e]:n&&t.get&&"function"==typeof t.get&&(r=t.get(e))),r}function r(e,t,n,r){function o(){}function i(){}o.prototype=e,i.prototype=e.subs;var s,a=new o;a.subs=new i,a.subsText={},a.ib();for(s in t)a.subs[s]=t[s],a.subsText[s]=r;for(s in n)a.partials[s]=n[s];return a}function o(e){return(null===e||void 0===e?"":e)+""}function i(e){return e=o(e),f.test(e)?e.replace(s,"&amp;").replace(a,"&lt;").replace(l,"&gt;").replace(c,"&#39;").replace(u,"&quot;"):e}e.Template=function(e,t,n,r){e=e||{},this.r=e.code||this.r,this.c=n,this.options=r||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.ib()
},e.Template.prototype={r:function(){return""},v:i,t:o,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},ep:function(e,t){var n=this.partials[e],o=t[n.name];if(n.instance&&n.base==o)return n.instance;if("string"==typeof o){if(!this.c)throw Error("No compiler available.");o=this.c.compile(o,this.options)}return o?(this.partials[e].base=o,n.subs&&(void 0===this.activeSub&&(t.stackText=this.text),o=r(o,n.subs,n.partials,t.stackText||this.text)),this.partials[e].instance=o,o):null
},rp:function(e,t,n,r){var o=this.ep(e,n);return o?o.ri(t,n,r):""},rs:function(e,t,n){var r=e[e.length-1];if(!m(r))return n(e,t,this),void 0;for(var o=0;r.length>o;o++)e.push(r[o]),n(e,t,this),e.pop()},s:function(e,t,n,r,o,i,s){var a;return m(e)&&0===e.length?!1:("function"==typeof e&&(e=this.ms(e,t,n,r,o,i,s)),a=!!e,!r&&a&&t&&t.push("object"==typeof e?e:t[t.length-1]),a)},d:function(e,t,r,o){var i,s=e.split("."),a=this.f(s[0],t,r,o),l=this.options.modelGet,c=null;if("."===e&&m(t[t.length-2]))a=t[t.length-1];
else for(var u=1;s.length>u;u++)i=n(s[u],a,l),null!=i?(c=a,a=i):a="";return o&&!a?!1:(o||"function"!=typeof a||(t.push(c),a=this.mv(a,t,r),t.pop()),a)},f:function(e,t,r,o){for(var i=!1,s=null,a=!1,l=this.options.modelGet,c=t.length-1;c>=0;c--)if(s=t[c],i=n(e,s,l),null!=i){a=!0;break}return a?(o||"function"!=typeof i||(i=this.mv(i,t,r)),i):o?!1:""},ls:function(e,t,n,r,i){var s=this.options.delimiters;return this.options.delimiters=i,this.b(this.ct(o(e.call(t,r)),t,n)),this.options.delimiters=s,!1},ct:function(e,t,n){if(this.options.disableLambda)throw Error("Lambda features disabled.");
return this.c.compile(e,this.options).render(t,n)},b:t?function(e){this.buf.push(e)}:function(e){this.buf+=e},fl:t?function(){var e=this.buf.join("");return this.buf=[],e}:function(){var e=this.buf;return this.buf="",e},ib:function(){this.buf=t?[]:""},ms:function(e,t,n,r,o,i,s){var a,l=t[t.length-1],c=e.call(l);return"function"==typeof c?r?!0:(a=this.activeSub&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(c,l,n,a.substring(o,i),s)):c},mv:function(e,t,n){var r=t[t.length-1],i=e.call(r);
return"function"==typeof i?this.ct(o(i.call(r)),r,n):i},sub:function(e,t,n,r){var o=this.subs[e];o&&(this.activeSub=e,o(t,n,this,r),this.activeSub=!1)}};var s=/&/g,a=/</g,l=/>/g,c=/\'/g,u=/\"/g,f=/[&<>\"\']/,m=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}})("undefined"!=typeof exports?exports:Hogan),function(e){var t=function(){return+new Date},n=!!e.XDomainRequest,r="withCredentials"in new XMLHttpRequest||n,o=!1,i=2e4,s={};try{o=new Worker("js/hnapi-worker.js"),o.addEventListener("message",function(e){var t=e.data,n=t.url||"";
if(s[n]){var r=s[n];t.error?r.error(t.error):r.success(t.response),delete s[n]}},!1)}catch(a){}var l=function(a,l,c){if(l||(l=function(){}),c||(c=function(){}),r)if(o)s[a]={success:l,error:c},o.postMessage({url:a,timeout:i});else{var u=s[a]||(n?new XDomainRequest:new XMLHttpRequest);u._timeout&&clearTimeout(u._timeout),u._timeout=setTimeout(function(){u.abort()},i),u.onload=function(){clearTimeout(this._timeout),delete s[a];try{l(JSON.parse(this.responseText))}catch(e){c(e)}},u.onerror=u.onabort=u.ontimeout=function(e){clearTimeout(this._timeout),delete s[a],c(e)
},(1>=u.readyState||n)&&(u.open("GET",a+"?"+t(),!0),u.send()),s[a]=u}else{var f=e.document,m=f.createElement("script"),p="callback"+t();e[p]=l,m.onerror=c,m.src=a+"?callback="+p,f.body.appendChild(m)}},c=["http://node-hnapi.herokuapp.com/","http://node-hnapi.azurewebsites.net/","http://node-hnapi-asia.azurewebsites.net/","http://node-hnapi-eus.azurewebsites.net/","http://node-hnapi-weu.azurewebsites.net/","http://node-hnapi-wus.azurewebsites.net/","http://node-hnapi-ncus.azurewebsites.net/"],u=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[t];
e[t]=e[n],e[n]=r}};u(c);var f=c.length,m=function(e,t,n,r){var o=f-1>e?function(){m(e+1,t,n,r)}:r;l(c[e]+t,n,o)},p=function(e,t,n){l(c[0]+e,t,function(){m(0,e,t,n)})},d={urls:c,news:function(e,t){p("news",e,t)},news2:function(e,t){p("news2",e,t)},item:function(e,t,n){p("item/"+e,t,n)},comments:function(e,t,n){p("comments/"+e,t,n)}};e.hnapi=d}(window),function(e){var t=e.document,n=function(e,n){var r=t.documentElement,o=r.matchesSelector||r.mozMatchesSelector||r.webkitMatchesSelector||r.oMatchesSelector||r.msMatchesSelector;
return o.call(e,n)},r=function(e,t){var r=!1;do r=n(e,t);while(!r&&(e=e.parentNode)&&e.ownerDocument);return r?e:!1};e.ibento=function(e,n,o){var i=t.body;i.addEventListener(n,function(t){var n=r(t.target,e);n&&o.call(i,t,n)})}}(window),"undefined"==typeof document||"classList"in document.createElement("a")||function(e){"use strict";if("HTMLElement"in e||"Element"in e){var t="classList",n="prototype",r=(e.HTMLElement||e.Element)[n],o=Object,i=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")
},s=Array[n].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},a=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},l=function(e,t){if(""===t)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},c=function(e){for(var t=i.call(e.className),n=t?t.split(/\s+/):[],r=0,o=n.length;o>r;r++)this.push(n[r]);this._updateClassName=function(){e.className=""+this
}},u=c[n]=[],f=function(){return new c(this)};if(a[n]=Error[n],u.item=function(e){return this[e]||null},u.contains=function(e){return e+="",-1!==l(this,e)},u.add=function(){var e,t=arguments,n=0,r=t.length,o=!1;do e=t[n]+"",-1===l(this,e)&&(this.push(e),o=!0);while(r>++n);o&&this._updateClassName()},u.remove=function(){var e,t=arguments,n=0,r=t.length,o=!1;do{e=t[n]+"";var i=l(this,e);-1!==i&&(this.splice(i,1),o=!0)}while(r>++n);o&&this._updateClassName()},u.toggle=function(e,t){e+="";var n=this.contains(e),r=n?t!==!0&&"remove":t!==!1&&"add";
return r&&this[r](e),!n},u.toString=function(){return this.join(" ")},o.defineProperty){var m={get:f,enumerable:!0,configurable:!0};try{o.defineProperty(r,t,m)}catch(p){-2146823252===p.number&&(m.enumerable=!1,o.defineProperty(r,t,m))}}else o[n].__defineGetter__&&r.__defineGetter__(t,f)}}(self),function(e){TEMPLATES={"comments-toggle":new e({code:function(e,t,n){var r=this;return r.b(n=n||""),r.b('<button class="comments-toggle">'),r.b(r.v(r.f("comments_count",e,t,0))),r.b(" "),r.b(r.v(r.f("i_reply",e,t,0))),r.b("</button>"),r.fl()
},partials:{},subs:{}}),comments:new e({code:function(e,t,n){var r=this;return r.b(n=n||""),r.s(r.f("comments",e,t,1),e,t,0,13,189,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<li><p class="metadata"><b>'),n.b(n.v(n.f("user",e,t,0))),n.b('</b> <time><a href="#" data-id="'),n.b(n.v(n.f("id",e,t,0))),n.b('" class="comment-permalink">'),n.b(n.v(n.f("time_ago",e,t,0))),n.b("</a></time></p><p>"),n.b(n.t(n.f("content",e,t,0))),n.b("<ul>"),n.b(n.rp("<comments_list0",e,t,"")),n.b("</ul></li>")}),e.pop()),r.fl()
},partials:{"<comments_list0":{name:"comments_list",partials:{},subs:{}}},subs:{}}),"post-comments":new e({code:function(e,t,n){var r=this;return r.b(n=n||""),r.b('<div class="post-content">'),r.s(r.f("has_post",e,t,1),e,t,0,39,577,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<header><h1><a href="'),n.b(n.v(n.f("url",e,t,0))),n.b('" target="_blank">'),n.b(n.v(n.f("title",e,t,0))),n.b("<br>"),n.s(n.f("user",e,t,1),e,t,0,107,170,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.s(n.f("domain",e,t,1),e,t,0,118,159,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<span class="link-text">'),n.b(n.v(n.f("domain",e,t,0))),n.b("</span>")
}),e.pop())}),e.pop()),n.b('</a></h1><p class="metadata">'),n.s(n.f("user",e,t,1),e,t,0,217,412,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<span class="inline-block">'),n.b(n.v(n.f("points",e,t,0))),n.b(" "),n.b(n.v(n.f("i_point",e,t,0))),n.b(" by "),n.b(n.v(n.f("user",e,t,0))),n.b('</span> <span class="inline-block">'),n.b(n.v(n.f("time_ago",e,t,0))),n.s(n.f("comments_count",e,t,1),e,t,0,344,386,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b(" &middot; "),n.b(n.v(n.f("comments_count",e,t,0))),n.b(" "),n.b(n.v(n.f("i_comment",e,t,0)))
}),e.pop()),n.b("</span>")}),e.pop()),n.s(n.f("user",e,t,1),e,t,1,0,0,"")||(n.b('<span class="inline-block">'),n.b(n.v(n.f("time_ago",e,t,0))),n.b("</span>")),n.b('<a href="'),n.b(n.v(n.f("hn_url",e,t,0))),n.b('" target="_blank" class="external-link">'),n.b(n.v(n.f("short_hn_url",e,t,0))),n.b("</a></p></header>")}),e.pop()),r.s(r.f("has_content",e,t,1),e,t,0,606,929,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<section class="grouped-tableview">'),n.b(n.t(n.f("content",e,t,0))),n.s(n.f("has_poll",e,t,1),e,t,0,667,906,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<ul class="poll">'),n.s(n.f("poll",e,t,1),e,t,0,693,892,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<li title="'),n.b(n.v(n.f("percentage",e,t,0))),n.b('%"><span class="poll-details"><b>'),n.b(n.v(n.f("item",e,t,0))),n.b('</b> <span class="points">'),n.b(n.v(n.f("points",e,t,0))),n.b(" "),n.b(n.v(n.f("i_point",e,t,0))),n.b('</span></span><div class="poll-bar"><span style="width: '),n.b(n.v(n.f("width",e,t,0))),n.b('"></span></div></li>')
}),e.pop()),n.b("</ul>")}),e.pop()),n.b("</section>")}),e.pop()),r.b('</div><section class="comments">'),r.s(r.f("loading",e,t,1),e,t,0,989,1030,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<div class="loader">Loading&hellip;</div>')}),e.pop()),r.s(r.f("load_error",e,t,1),e,t,0,1057,1140,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<div class="load-error">Couldn\'t load comments.<br><button>Try again</button></div>')}),e.pop()),r.s(r.f("loading",e,t,1),e,t,1,0,0,"")||r.s(r.f("load_error",e,t,1),e,t,1,0,0,"")||(r.s(r.f("has_comments",e,t,1),e,t,0,1199,1226,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b("<ul>"),n.b(n.rp("<comments_list0",e,t,"")),n.b("</ul>")
}),e.pop()),r.s(r.f("has_comments",e,t,1),e,t,1,0,0,"")||r.b('<p class="no-comments">No comments.</p>')),r.b("</section>"),r.fl()},partials:{"<comments_list0":{name:"comments_list",partials:{},subs:{}}},subs:{}}),post:new e({code:function(e,t,n){var r=this;return r.b(n=n||""),r.b('<li id="story-'),r.b(r.v(r.f("id",e,t,0))),r.b('" data-index="'),r.b(r.v(r.f("i",e,t,0))),r.b('" class="post-'),r.b(r.v(r.f("type",e,t,0))),r.b('"><a href="'),r.b(r.v(r.f("url",e,t,0))),r.b('" class="'),r.s(r.f("detail_disclosure",e,t,1),e,t,0,110,127,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b("detail-disclosure")
}),e.pop()),r.s(r.f("disclosure",e,t,1),e,t,0,164,174,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b("disclosure")}),e.pop()),r.b(" "),r.s(r.f("selected",e,t,1),e,t,0,203,211,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b("selected")}),e.pop()),r.b('"><div class="number">'),r.b(r.v(r.f("i",e,t,0))),r.b('.</div><div class="story"><b>'),r.b(r.v(r.f("title",e,t,0))),r.b("</b>"),r.s(r.f("user",e,t,1),e,t,0,302,594,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<span class="metadata">'),n.s(n.f("domain",e,t,1),e,t,0,336,381,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<span class="link-text">'),n.b(n.v(n.f("domain",e,t,0))),n.b("</span><br>")
}),e.pop()),n.b('<span class="inline-block">'),n.b(n.v(n.f("points",e,t,0))),n.b(" "),n.b(n.v(n.f("i_point",e,t,0))),n.b(" by "),n.b(n.v(n.f("user",e,t,0))),n.b('</span> <span class="inline-block">'),n.b(n.v(n.f("time_ago",e,t,0))),n.s(n.f("comments_count",e,t,1),e,t,0,519,561,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b(" &middot; "),n.b(n.v(n.f("comments_count",e,t,0))),n.b(" "),n.b(n.v(n.f("i_comment",e,t,0)))}),e.pop()),n.b("</span></span>")}),e.pop()),r.s(r.f("user",e,t,1),e,t,1,0,0,"")||(r.b('<span class="metadata">'),r.s(r.f("domain",e,t,1),e,t,0,646,691,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<span class="link-text">'),n.b(n.v(n.f("domain",e,t,0))),n.b("</span><br>")
}),e.pop()),r.b('<span class="inline-block">'),r.b(r.v(r.f("time_ago",e,t,0))),r.b("</span></span>")),r.b("</div></a>"),r.s(r.f("detail_disclosure",e,t,1),e,t,0,796,870,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<a href="#/item/'),n.b(n.v(n.f("id",e,t,0))),n.b('" class="detail-disclosure-button"><span></span></a>')}),e.pop()),r.b("</li>"),r.fl()},partials:{},subs:{}}),"stories-load":new e({code:function(e,t,n){var r=this;return r.b(n=n||""),r.s(r.f("loading",e,t,1),e,t,0,12,53,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<div class="loader">Loading&hellip;</div>')
}),e.pop()),r.s(r.f("load_error",e,t,1),e,t,0,80,132,"{{ }}")&&(r.rs(e,t,function(e,t,n){n.b('<div class="load-error">Couldn\'t load stories.</div>')}),e.pop()),r.fl()},partials:{},subs:{}})}}(Hogan.Template),function(e){var t=e.document,n=e.$=function(e){return t.getElementById(e)},r={},o=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},i={pub:function(e,t){var n=r[e];if(n)for(var o=0,i=n.length;i>o;o++)n[o].call(this,t)},sub:function(e,t){r[e]||(r[e]=[]),r[e].push(t)
},currentView:null,hideAllViews:function(){for(var e=t.querySelectorAll(".view"),n=0,r=e.length;r>n;n++)e[n].classList.add("hidden")},tmpl:function(e,t){var n=TEMPLATES[e];if(n)return t?n.render(t):n},setTitle:function(e){var t="HackerWeb";e&&(e=e.replace(/^\s+|\s+$/g,""),e.toLowerCase()!=t.toLowerCase()&&(t=e+" – "+t)),document.title=t}};"undefined"!=typeof _gaq&&i.sub("logAPIError",function(e){_gaq.push(["_trackEvent","Errors","API",e])});var s=i.tmpl;amplify.store.sessionStorage&&"function"==typeof amplify.store.sessionStorage||(amplify.store.sessionStorage=amplify.store.memory);
var a=t.querySelector("#view-home .scroll"),l=a.querySelector("section"),c=!1;i.news={options:{disclosure:!0},markupStory:function(e){if(/^item/i.test(e.url))e.url="#/item/"+e.id;else{e.external=!0;var n=t.createElement("a");n.href=e.url,e.domain=n.hostname.replace(/^www\./,""),delete n}return i.news.options.disclosure?("link"==e.type&&(e.detail_disclosure=!0),/^#\//.test(e.url)&&(e.disclosure=!0,e.domain=null)):e.id&&(e.url="#/item/"+e.id),e.i_point=1==e.points?"point":"points",e.i_comment=1==e.comments_count?"comment":"comments",s("post",e)
},markupStories:function(e,t){var n="";t||(t=1);var r=i.news.markupStory;return e.forEach(function(e){e.i=t++,n+=r(e)}),n},updateStory:function(e){if(e&&e.id){var t,r=e.id,o=e.data,s="hacker-news",a=amplify.store(s);if(a)for(var l=0,c=a.length;c>l;l++){var u=a[l];if(r==u.id){t=u;break}}if(!t&&(s="hacker-news2",a=amplify.store(s)))for(var l=0,c=a.length;c>l;l++){var u=a[l];if(r==u.id){t=u;break}}if(t){var f=!1;if(["title","url","time_ago","comments_count","points"].forEach(function(e){var n=o[e];t[e]!=n&&(t[e]=n,f=!0)
}),f){amplify.store(s,a);var m=n("story-"+r);m&&(t.selected=!!m.querySelector("a[href].selected"),t.i=m.dataset?m.dataset.index:m.getAttribute("data-index"),m.insertAdjacentHTML("afterend",i.news.markupStory(t)),m.parentNode.removeChild(m))}}}},render:function(e){if(!c){e||(e={});var t=amplify.store("hacker-news-cached"),r=s("stories-load"),o=function(e){var t=e.slice(),n='<ul class="tableview tableview-links" id="hwlist">'+i.news.markupStories(t)+(amplify.store("hacker-news2")?'<li><a class="more-link">More&hellip;<span class="loader"></span></a></li>':"")+"</ul>";
l.innerHTML=n,i.pub("onRenderNews")};if(t){var a=amplify.store("hacker-news"),u=e.delay;u?(c=!0,l.innerHTML=r.render({loading:!0}),setTimeout(function(){c=!1,o(a)},u)):o(a)}else{c=!0,l.innerHTML=r.render({loading:!0});var f=function(){l.innerHTML=r.render({load_error:!0}),i.pub("logAPIError","news")};hnapi.news(function(e){return c=!1,!e||e.error?(f(),void 0):(amplify.store("hacker-news",e),amplify.store("hacker-news-cached",!0,{expires:6e5}),amplify.store("hacker-news2",null),o(e),hnapi.news2(function(e){e&&!e.error&&(amplify.store("hacker-news2",e),n("hwlist").insertAdjacentHTML("beforeend",'<li><a class="more-link">More&hellip;<span class="loader"></span></a></li>'))
}),void 0)},function(){c=!1,f()})}}},reload:function(){i.news.render({delay:300})},more:function(e){e.classList.add("loading");var t=amplify.store("hacker-news2");setTimeout(function(){e.classList.remove("loading");var r=e.parentNode;if(r&&(r.parentNode&&r.parentNode.removeChild(r),t)){var o=t.slice(),s=i.news.markupStories(o,31);n("hwlist").insertAdjacentHTML("beforeend",s)}},400)}};var u=n("view-comments"),f=u.querySelector("header h1"),m=u.querySelector("section");i.comments={currentID:null,render:function(e){if(e){var n=amplify.store.sessionStorage("hacker-item-"+e);
if(i.comments.currentID!=e||!n){i.comments.currentID=e;var r=function(e,t){if(e&&!e.error){var n=o(e);amplify.store.sessionStorage("hacker-comments-"+t,n);var r=m.querySelector(".comments>ul");if(r.querySelector(".more-link-container")||r.insertAdjacentHTML("beforeend",'<li class="more-link-container"><a class="more-link" data-id="'+t+'">More&hellip;</a></li>'),n.more_comments_id){var i=function(e){var t=amplify.store.sessionStorage("hacker-comments-"+e);t?t.more_comments_id&&i(t.more_comments_id):hnapi.comments(e,function(t){t&&!t.error&&(amplify.store.sessionStorage("hacker-comments-"+e,t),t.more_comments_id&&i(t.more_comments_id))
})};i(n.more_comments_id)}}},a=function(e,n){var a=o(e),l=s("post-comments");if(a.has_post=!!a.title,!a.has_post)return i.setTitle(),f.innerHTML="",m.innerHTML=l.render(a),i.pub("adjustCommentsSection"),i.pub("onRenderComments"),void 0;var c=s("comments"),u=t.createElement("a");if(/^item/i.test(a.url)?a.url="http://news.ycombinator.com/"+a.url:(u.href=a.url,a.domain=u.hostname.replace(/^www\./,"")),a.has_comments=a.comments&&!!a.comments.length,a.i_point=1==a.points?"point":"points",a.i_comment=1==a.comments_count?"comment":"comments",a.has_content=!!a.content,a.poll){var p=0,d=0;
a.poll.forEach(function(e){var t=e.points;t>d&&(d=t),p+=t,e.i_point=1==t?"point":"points"}),a.poll.forEach(function(e){var t=e.points;e.percentage=(100*(t/p)).toFixed(1),e.width=(100*(t/d)).toFixed(1)+"%"}),a.has_poll=a.has_content=!0}a.short_hn_url="news.ycombinator.com/item?id="+n,a.hn_url="http://"+a.short_hn_url,i.setTitle(a.title),f.innerHTML=a.title;var h=l.render(a,{comments_list:c}),b=t.createElement("div");b.innerHTML=h;for(var v=b.querySelectorAll("a"),g=0,y=v.length;y>g;g++){var w=v[g];
if(w.classList.contains("comment-permalink")){var n=w.dataset?w.dataset.id:w.getAttribute("data-id");w.href="http://news.ycombinator.com/item?id="+n}w.target="_blank"}if(h.length>2e4)for(var _=b.querySelectorAll(".comments>ul>li>ul"),k=s("comments-toggle"),S=0,y=_.length;y>S;S++){var T=_[S],x=T.querySelectorAll(".metadata").length;T.style.display="none",x&&T.insertAdjacentHTML("beforebegin",k.render({comments_count:x,i_reply:1==x?"reply":"replies"}))}for(;m.hasChildNodes();)m.removeChild(m.childNodes[0]);
for(;b.hasChildNodes();)m.appendChild(b.childNodes[0]);if(delete b,a.more_comments_id){var n=a.more_comments_id,E=amplify.store.sessionStorage("hacker-comments-"+n);E?r(E,n):hnapi.comments(n,function(e){r(e,n)})}i.pub("onRenderComments")};if(n)m.scrollTop=0,a(n,e);else{var l=amplify.store("hacker-news");if(l)for(var c=0,u=l.length;u>c;c++){var p=l[c];if(e==p.id){n=p;break}}if(!n){var l=amplify.store("hacker-news2");if(l)for(var c=0,u=l.length;u>c;c++){var p=l[c];if(e==p.id){n=p;break}}}n?(n.loading=!0,a(n,e)):a({loading:!0},e);
var d=function(){n?(delete n.loading,n.load_error=!0,a(n,e)):a({load_error:!0},e),i.pub("logAPIError","comments")};hnapi.item(e,function(t){if(i.comments.currentID==e){if(!t||t.error&&"comments"==i.currentView)return d(),void 0;amplify.store.sessionStorage("hacker-item-"+e,t,{expires:3e5}),i.news.updateStory({id:e,data:t}),a(t,e)}},function(){i.comments.currentID==e&&d()})}}}},toggle:function(e){var t=e.nextElementSibling;if(t){var n=t.style,r=m.scrollTop;n.display="none"==n.display?"":"none",m.scrollTop=r
}},more:function(e){var n=e.dataset?e.dataset.id:e.getAttribute("data-id"),r=amplify.store.sessionStorage("hacker-comments-"+n);if(r){var o=s("comments"),i=s("comments"),a=o.render(r,{comments_list:o}),l=e.parentNode,c=l.parentNode,u=r.more_comments_id,f=t.createElement("ul");f.innerHTML=a;for(var m=f.querySelectorAll("a"),p=0,d=m.length;d>p;p++)m[p].target="_blank";for(var h=f.children,p=0,d=h.length;d>p;p++){var b=h[p].getElementsByTagName("ul")[0],v=b.querySelectorAll(".metadata").length;b.style.display="none",v&&b.insertAdjacentHTML("beforebegin",i.render({comments_count:v,i_reply:1==v?"reply":"replies"}))
}for(u&&amplify.store.sessionStorage("hacker-comments-"+u)&&f.insertAdjacentHTML("beforeend",'<li class="more-link-container"><a class="more-link" data-id="'+u+'">More&hellip;</a></li>'),c.removeChild(l);f.hasChildNodes();)c.appendChild(f.childNodes[0]);delete f}else alert("Oops, the comments have expired.")},reload:function(){i.comments.currentID=null,ruto.reload()}},i.init=function(){i.news.render(),ruto.init()},e.hw=i,ruto.config({before:function(e,t){i.hideAllViews();var r=n("view-"+t);r.classList.remove("hidden"),i.currentView=t,i.setTitle(r.querySelector("header h1").textContent)
},notfound:function(){ruto.go("/")}}).add("/","home").add("/about","about").add(/^\/item\/(\d+)$/i,"comments",function(e,t){i.comments.render(t)})}(window),function(e){if(e.addEventListener){var t,n=e.document,r=n.body,o={},i=function(){return e.pageYOffset||"CSS1Compat"===n.compatMode&&n.documentElement.scrollTop||r.scrollTop||0},s=function(){o[location.hash.slice(1)]=i()};e.addEventListener("scroll",function(){clearTimeout(t),t=setTimeout(s,500)},!1),ruto.config({on:function(){var t=location.hash.slice(1);
e.scrollTo(0,o[t]||0),o[t]=i()}});var a=n.head||n.getElementsByTagName("head")[0],l=function(){var e=window.innerHeight,t=$("view-height");t||(t=n.createElement("style"),t.id="view-height",a.appendChild(t)),t.textContent=".view>.scroll{min-height: "+.85*e+"px}"};e.addEventListener("resize",l,!1),e.addEventListener("orientationchange",l,!1),l(),ibento("#view-home-refresh","click",hw.news.reload),ibento("#view-home .more-link","click",function(e,t){hw.news.more(t)}),ibento("button.comments-toggle","click",function(e,t){hw.comments.toggle(t)
}),ibento("section.comments li>a.more-link","click",function(e,t){hw.comments.more(t)}),ibento("#view-comments .load-error button","click",hw.comments.reload),hw.init()}}(window);
//@ sourceMappingURL=hw-web.min.js.map